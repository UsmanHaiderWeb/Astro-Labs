import{r as c,j as m}from"./index-DMkccXl_.js";import{g as H,c as Y,e as V,b as W,d as g,u as q,a as J,h as Q}from"./index-BdjukbCb.js";import{u as X}from"./index-Dwshsc2j.js";import{P as D}from"./index-BUIlqyS-.js";function ve(e){const[t,r]=c.useState(void 0);return H(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const o=new ResizeObserver(d=>{if(!Array.isArray(d)||!d.length)return;const I=d[0];let v,p;if("borderBoxSize"in I){const i=I.borderBoxSize,s=Array.isArray(i)?i[0]:i;v=s.inlineSize,p=s.blockSize}else v=e.offsetWidth,p=e.offsetHeight;r({width:v,height:p})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}else r(void 0)},[e]),t}var y="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},S="RovingFocusGroup",[A,O,$]=V(S),[ee,pe]=Y(S,[$]),[oe,te]=ee(S),G=c.forwardRef((e,t)=>m.jsx(A.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(A.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(re,{...e,ref:t})})}));G.displayName=S;var re=c.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:o,loop:d=!1,dir:I,currentTabStopId:v,defaultCurrentTabStopId:p,onCurrentTabStopIdChange:i,onEntryFocus:s,preventScrollOnEntryFocus:E=!1,...h}=e,F=c.useRef(null),R=X(t,F),n=q(I),[l=null,w]=J({prop:v,defaultProp:p,onChange:i}),[u,f]=c.useState(!1),C=Q(s),j=O(r),x=c.useRef(!1),[k,_]=c.useState(0);return c.useEffect(()=>{const a=F.current;if(a)return a.addEventListener(y,C),()=>a.removeEventListener(y,C)},[C]),m.jsx(oe,{scope:r,orientation:o,dir:n,loop:d,currentTabStopId:l,onItemFocus:c.useCallback(a=>w(a),[w]),onItemShiftTab:c.useCallback(()=>f(!0),[]),onFocusableItemAdd:c.useCallback(()=>_(a=>a+1),[]),onFocusableItemRemove:c.useCallback(()=>_(a=>a-1),[]),children:m.jsx(D.div,{tabIndex:u||k===0?-1:0,"data-orientation":o,...h,ref:R,style:{outline:"none",...e.style},onMouseDown:g(e.onMouseDown,()=>{x.current=!0}),onFocus:g(e.onFocus,a=>{const L=!x.current;if(a.target===a.currentTarget&&L&&!u){const P=new CustomEvent(y,Z);if(a.currentTarget.dispatchEvent(P),!P.defaultPrevented){const T=j().filter(b=>b.focusable),M=T.find(b=>b.active),U=T.find(b=>b.id===l),B=[M,U,...T].filter(Boolean).map(b=>b.ref.current);K(B,E)}}x.current=!1}),onBlur:g(e.onBlur,()=>f(!1))})})}),z="RovingFocusGroupItem",N=c.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:o=!0,active:d=!1,tabStopId:I,...v}=e,p=W(),i=I||p,s=te(z,r),E=s.currentTabStopId===i,h=O(r),{onFocusableItemAdd:F,onFocusableItemRemove:R}=s;return c.useEffect(()=>{if(o)return F(),()=>R()},[o,F,R]),m.jsx(A.ItemSlot,{scope:r,id:i,focusable:o,active:d,children:m.jsx(D.span,{tabIndex:E?0:-1,"data-orientation":s.orientation,...v,ref:t,onMouseDown:g(e.onMouseDown,n=>{o?s.onItemFocus(i):n.preventDefault()}),onFocus:g(e.onFocus,()=>s.onItemFocus(i)),onKeyDown:g(e.onKeyDown,n=>{if(n.key==="Tab"&&n.shiftKey){s.onItemShiftTab();return}if(n.target!==n.currentTarget)return;const l=ce(n,s.orientation,s.dir);if(l!==void 0){if(n.metaKey||n.ctrlKey||n.altKey||n.shiftKey)return;n.preventDefault();let u=h().filter(f=>f.focusable).map(f=>f.ref.current);if(l==="last")u.reverse();else if(l==="prev"||l==="next"){l==="prev"&&u.reverse();const f=u.indexOf(n.currentTarget);u=s.loop?ae(u,f+1):u.slice(f+1)}setTimeout(()=>K(u))}})})})});N.displayName=z;var ne={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function se(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ce(e,t,r){const o=se(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(o))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(o)))return ne[o]}function K(e,t=!1){const r=document.activeElement;for(const o of e)if(o===r||(o.focus({preventScroll:t}),document.activeElement!==r))return}function ae(e,t){return e.map((r,o)=>e[(t+o)%e.length])}var be=G,me=N;export{me as I,be as R,pe as c,ve as u};
