import{r as n,j as m}from"./index-CjcjHVsz.js";import{c as H,e as Y,b as V,d as g,u as W,a as q,f as J,g as Q}from"./index-EAtLFXt4.js";import{u as X}from"./utils-9FpsFH3W.js";import{P as D}from"./index-DWjbVXRo.js";var y="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},S="RovingFocusGroup",[A,O,$]=Y(S),[ee,ve]=H(S,[$]),[oe,te]=ee(S),G=n.forwardRef((e,o)=>m.jsx(A.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(A.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(re,{...e,ref:o})})}));G.displayName=S;var re=n.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:r,orientation:t,loop:d=!1,dir:I,currentTabStopId:v,defaultCurrentTabStopId:p,onCurrentTabStopIdChange:i,onEntryFocus:c,preventScrollOnEntryFocus:E=!1,...w}=e,F=n.useRef(null),R=X(o,F),s=W(I),[l=null,h]=q({prop:v,defaultProp:p,onChange:i}),[a,f]=n.useState(!1),C=J(c),M=O(r),x=n.useRef(!1),[j,_]=n.useState(0);return n.useEffect(()=>{const u=F.current;if(u)return u.addEventListener(y,C),()=>u.removeEventListener(y,C)},[C]),m.jsx(oe,{scope:r,orientation:t,dir:s,loop:d,currentTabStopId:l,onItemFocus:n.useCallback(u=>h(u),[h]),onItemShiftTab:n.useCallback(()=>f(!0),[]),onFocusableItemAdd:n.useCallback(()=>_(u=>u+1),[]),onFocusableItemRemove:n.useCallback(()=>_(u=>u-1),[]),children:m.jsx(D.div,{tabIndex:a||j===0?-1:0,"data-orientation":t,...w,ref:R,style:{outline:"none",...e.style},onMouseDown:g(e.onMouseDown,()=>{x.current=!0}),onFocus:g(e.onFocus,u=>{const k=!x.current;if(u.target===u.currentTarget&&k&&!a){const P=new CustomEvent(y,Z);if(u.currentTarget.dispatchEvent(P),!P.defaultPrevented){const T=M().filter(b=>b.focusable),L=T.find(b=>b.active),U=T.find(b=>b.id===l),B=[L,U,...T].filter(Boolean).map(b=>b.ref.current);K(B,E)}}x.current=!1}),onBlur:g(e.onBlur,()=>f(!1))})})}),z="RovingFocusGroupItem",N=n.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:r,focusable:t=!0,active:d=!1,tabStopId:I,...v}=e,p=V(),i=I||p,c=te(z,r),E=c.currentTabStopId===i,w=O(r),{onFocusableItemAdd:F,onFocusableItemRemove:R}=c;return n.useEffect(()=>{if(t)return F(),()=>R()},[t,F,R]),m.jsx(A.ItemSlot,{scope:r,id:i,focusable:t,active:d,children:m.jsx(D.span,{tabIndex:E?0:-1,"data-orientation":c.orientation,...v,ref:o,onMouseDown:g(e.onMouseDown,s=>{t?c.onItemFocus(i):s.preventDefault()}),onFocus:g(e.onFocus,()=>c.onItemFocus(i)),onKeyDown:g(e.onKeyDown,s=>{if(s.key==="Tab"&&s.shiftKey){c.onItemShiftTab();return}if(s.target!==s.currentTarget)return;const l=ce(s,c.orientation,c.dir);if(l!==void 0){if(s.metaKey||s.ctrlKey||s.altKey||s.shiftKey)return;s.preventDefault();let a=w().filter(f=>f.focusable).map(f=>f.ref.current);if(l==="last")a.reverse();else if(l==="prev"||l==="next"){l==="prev"&&a.reverse();const f=a.indexOf(s.currentTarget);a=c.loop?ue(a,f+1):a.slice(f+1)}setTimeout(()=>K(a))}})})})});N.displayName=z;var ne={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function se(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ce(e,o,r){const t=se(e.key,r);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return ne[t]}function K(e,o=!1){const r=document.activeElement;for(const t of e)if(t===r||(t.focus({preventScroll:o}),document.activeElement!==r))return}function ue(e,o){return e.map((r,t)=>e[(o+t)%e.length])}var pe=G,be=N;function me(e){const o=n.useRef({value:e,previous:e});return n.useMemo(()=>(o.current.value!==e&&(o.current.previous=o.current.value,o.current.value=e),o.current.previous),[e])}function Ie(e){const[o,r]=n.useState(void 0);return Q(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const t=new ResizeObserver(d=>{if(!Array.isArray(d)||!d.length)return;const I=d[0];let v,p;if("borderBoxSize"in I){const i=I.borderBoxSize,c=Array.isArray(i)?i[0]:i;v=c.inlineSize,p=c.blockSize}else v=e.offsetWidth,p=e.offsetHeight;r({width:v,height:p})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}else r(void 0)},[e]),o}export{be as I,pe as R,me as a,ve as c,Ie as u};
